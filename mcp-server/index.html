<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>실시간 주가 대시보드</title>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #f0f2f5; }
        #stock-card { background-color: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center; }
        h1 { margin-top: 0; }
        #price { font-size: 2.5rem; font-weight: bold; }
        #change { font-size: 1.2rem; }
        .positive { color: green; }
        .negative { color: red; }
    </style>
</head>
<body>

    <div id="stock-card">
        <h1 id="symbol">AAPL</h1>
        <div id="price">...</div>
        <div id="change">...</div>
        <small id="timestamp">...</small>
    </div>

    <script>
        const stockSymbol = 'AAPL'; // 원하는 주식 심볼로 변경 가능

        async function fetchStockPrice() {
            try {
                const response = await fetch(`http://localhost:3000/api/stock/${stockSymbol}`);
                const data = await response.json();

                document.getElementById('symbol').innerText = data.symbol;
                document.getElementById('price').innerText = `$${data.price.toFixed(2)}`;
                
                const changeElement = document.getElementById('change');
                const changeText = `${data.change.toFixed(2)} (${data.changePercent.toFixed(2)}%)`;
                changeElement.innerText = changeText;

                // 가격 변동에 따라 색상 변경
                if (data.change > 0) {
                    changeElement.className = 'positive';
                } else {
                    changeElement.className = 'negative';
                }

                document.getElementById('timestamp').innerText = `Updated: ${new Date(data.timestamp).toLocaleTimeString()}`;

            } catch (error) {
                console.error('Failed to fetch stock price:', error);
                document.getElementById('price').innerText = '오류';
            }
        }

        // 5초마다 주가 정보 업데이트
        fetchStockPrice(); // 페이지 로드 시 즉시 실행
        setInterval(fetchStockPrice, 5000);
    </script>

</body>
</html>